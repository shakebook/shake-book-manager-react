{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/Users/yangjiafeng/web-src/shake-book-manager/src/pages/content/pages/menu/index.tsx\",\n    _s = $RefreshSig$();\n\nimport * as React from 'react';\nimport { Table, Button, Modal, Input, Form, TreeSelect, message, Space } from 'antd';\nimport { useSelector, useDispatch } from \"react-redux\";\nimport * as actions from './store/actions';\nimport { ExclamationCircleOutlined } from '@ant-design/icons';\nconst layout = {\n  labelCol: {\n    span: 6\n  },\n  wrapperCol: {\n    span: 15\n  }\n};\nconst {\n  confirm\n} = Modal;\n\nconst Menu = () => {\n  _s();\n\n  const [visible, setVisible] = React.useState(false);\n  const [menuName, setMenuName] = React.useState(\"\");\n  const [menuIcon, setMenuIcon] = React.useState(\"\");\n  const [menuRouter, setMenuRouter] = React.useState(\"\");\n  const [parentId, setParentId] = React.useState(\"\");\n  const [id, setId] = React.useState(0);\n  const dispatch = useDispatch();\n  const menuState = useSelector(state => state.menu);\n  const columns = [{\n    title: '菜单名称',\n    dataIndex: 'title',\n    key: 'title'\n  }, {\n    title: '菜单路由',\n    dataIndex: 'menuRouter',\n    key: 'menuRouter'\n  }, {\n    title: '菜单图标',\n    dataIndex: 'menuIcon',\n    key: 'menuIcon'\n  }, {\n    title: '操作',\n    key: 'action',\n    render: (text, record) => /*#__PURE__*/_jsxDEV(Space, {\n      size: \"small\",\n      children: [/*#__PURE__*/_jsxDEV(Button, {\n        type: \"primary\",\n        ghost: true,\n        size: \"small\",\n        onClick: () => showModel({\n          menuRouter: record.menuRouter,\n          id: record.key,\n          menuName: record.menuName,\n          menuIcon: record.menuIcon,\n          parentId: record.parentId\n        }),\n        children: \"\\u4FEE\\u6539\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 48,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        type: \"primary\",\n        ghost: true,\n        danger: true,\n        size: \"small\",\n        onClick: () => deleteConfirm(record),\n        children: \"\\u5220\\u9664\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 56,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 47,\n      columnNumber: 9\n    }, this)\n  }];\n  React.useEffect(() => {\n    dispatch(actions.getMenuListRequest());\n  }, [dispatch]);\n\n  const deleteConfirm = record => {\n    confirm({\n      title: '这个是一个危险操作?',\n      icon: /*#__PURE__*/_jsxDEV(ExclamationCircleOutlined, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 13\n      }, this),\n      content: '确定执行删除操作吗？',\n      okText: '确定',\n      okType: 'danger',\n      cancelText: '取消',\n\n      onOk() {\n        dispatch(actions.deleteRowRequest({\n          id: record.key\n        }));\n      }\n\n    });\n  };\n\n  const submit = () => {\n    if (!menuName) {\n      message.error('菜单名称不能为空');\n      return;\n    }\n\n    if (id) {\n      dispatch(actions.UpdateRowRequest({\n        menuName: menuName,\n        id: id,\n        menuIcon: menuIcon,\n        menuRouter: menuRouter,\n        parentId: parentId\n      }));\n    } else {\n      dispatch(actions.createMenuRequest({\n        menuName: menuName.trim(),\n        menuIcon: menuIcon.trim(),\n        menuRouter: menuRouter.trim(),\n        parentId: Number(parentId)\n      }));\n    }\n\n    cancelModel();\n  };\n\n  const showModel = record => {\n    setMenuName(record.menuName || \"\");\n    setParentId(record.parentId || \"\");\n    setMenuIcon(record.menuIcon || \"\");\n    setMenuRouter(record.menuRouter || \"\");\n    setId(record.id);\n    setVisible(true);\n  };\n\n  const cancelModel = () => {\n    setVisible(false);\n    setMenuName(\"\");\n    setId(0);\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginBottom: '10px'\n      },\n      children: [/*#__PURE__*/_jsxDEV(Button, {\n        type: \"primary\",\n        onClick: () => showModel({}),\n        children: \"\\u65B0\\u589E\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(Modal, {\n        title: \"\\u83DC\\u5355\",\n        visible: visible,\n        onOk: submit,\n        onCancel: cancelModel,\n        okText: \"\\u786E\\u8BA4\",\n        cancelText: \"\\u53D6\\u6D88\",\n        style: {\n          top: 20\n        },\n        children: /*#__PURE__*/_jsxDEV(Form, { ...layout,\n          children: [/*#__PURE__*/_jsxDEV(Form.Item, {\n            label: \"\\u4E0A\\u7EA7\\u83DC\\u5355\",\n            children: /*#__PURE__*/_jsxDEV(TreeSelect, {\n              allowClear: true,\n              style: {\n                width: '100%'\n              },\n              value: parentId,\n              dropdownStyle: {\n                maxHeight: 600,\n                overflow: 'auto'\n              },\n              treeData: menuState.menuList,\n              placeholder: \"\\u8BF7\\u9009\\u62E9...\",\n              treeDefaultExpandAll: true,\n              onChange: v => setParentId(v)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 135,\n              columnNumber: 13\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 134,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(Form.Item, {\n            label: /*#__PURE__*/_jsxDEV(\"span\", {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                style: {\n                  color: \"red\"\n                },\n                children: \"*\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 146,\n                columnNumber: 35\n              }, this), \"\\u83DC\\u5355\\u540D\\u79F0\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 146,\n              columnNumber: 29\n            }, this),\n            children: /*#__PURE__*/_jsxDEV(Input, {\n              onChange: e => setMenuName(e.target.value),\n              value: menuName\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 147,\n              columnNumber: 13\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 146,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(Form.Item, {\n            label: \"\\u83DC\\u5355\\u8DEF\\u7531\",\n            children: /*#__PURE__*/_jsxDEV(Input, {\n              onChange: e => setMenuRouter(e.target.value),\n              value: menuRouter\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 153,\n              columnNumber: 13\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 152,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(Form.Item, {\n            label: \"\\u83DC\\u5355\\u56FE\\u6807\",\n            children: /*#__PURE__*/_jsxDEV(Input, {\n              onChange: e => setMenuIcon(e.target.value),\n              value: menuIcon\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 159,\n              columnNumber: 13\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 158,\n            columnNumber: 11\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 133,\n          columnNumber: 9\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(Table, {\n      columns: columns,\n      dataSource: menuState.menuList,\n      rowKey: record => record.id,\n      pagination: false\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 5\n    }, this)]\n  }, void 0, true);\n};\n\n_s(Menu, \"/UX3yxSSPKlfFve7s0xyp938bRM=\", false, function () {\n  return [useDispatch, useSelector];\n});\n\n_c = Menu;\nexport default Menu;\n\nvar _c;\n\n$RefreshReg$(_c, \"Menu\");","map":{"version":3,"sources":["/Users/yangjiafeng/web-src/shake-book-manager/src/pages/content/pages/menu/index.tsx"],"names":["React","Table","Button","Modal","Input","Form","TreeSelect","message","Space","useSelector","useDispatch","actions","ExclamationCircleOutlined","layout","labelCol","span","wrapperCol","confirm","Menu","visible","setVisible","useState","menuName","setMenuName","menuIcon","setMenuIcon","menuRouter","setMenuRouter","parentId","setParentId","id","setId","dispatch","menuState","state","menu","columns","title","dataIndex","key","render","text","record","showModel","deleteConfirm","useEffect","getMenuListRequest","icon","content","okText","okType","cancelText","onOk","deleteRowRequest","submit","error","UpdateRowRequest","createMenuRequest","trim","Number","cancelModel","marginBottom","top","width","maxHeight","overflow","menuList","v","color","e","target","value"],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport { Table, Button, Modal, Input, Form, TreeSelect, message, Space } from 'antd';\nimport { Dispatch } from \"redux\"\nimport { useSelector, useDispatch } from \"react-redux\"\nimport { manager } from '@/service/api/v1/manager_pb'\nimport * as actions from './store/actions'\nimport { RootStore } from \"@/store\";\nimport { ExclamationCircleOutlined } from '@ant-design/icons';\n\nconst layout = {\n  labelCol: { span: 6 },\n  wrapperCol: { span: 15 },\n};\n\nconst { confirm } = Modal;\n\nconst Menu: React.FC = () => {\n  const [visible, setVisible] = React.useState(false)\n  const [menuName, setMenuName] = React.useState<string>(\"\")\n  const [menuIcon, setMenuIcon] = React.useState<string>(\"\")\n  const [menuRouter, setMenuRouter] = React.useState<string>(\"\")\n  const [parentId, setParentId] = React.useState<number | string>(\"\")\n  const [id, setId] = React.useState<number | string>(0)\n  const dispatch: Dispatch<any> = useDispatch()\n  const menuState = useSelector((state: RootStore) => state.menu);\n\n  const columns = [\n    {\n      title: '菜单名称',\n      dataIndex: 'title',\n      key: 'title',\n    },\n    {\n      title: '菜单路由',\n      dataIndex: 'menuRouter',\n      key: 'menuRouter',\n    },\n    {\n      title: '菜单图标',\n      dataIndex: 'menuIcon',\n      key: 'menuIcon',\n    },\n    {\n      title: '操作',\n      key: 'action',\n      render: (text: string, record: actions.MenuTree) => (\n        <Space size=\"small\">\n          <Button type=\"primary\" ghost size=\"small\"\n            onClick={() => showModel({\n              menuRouter: record.menuRouter,\n              id: record.key,\n              menuName: record.menuName,\n              menuIcon: record.menuIcon,\n              parentId: record.parentId,\n            })}>修改</Button>\n          <Button type=\"primary\" ghost danger size=\"small\"\n            onClick={() => deleteConfirm(record)}\n          >删除</Button>\n        </Space>\n      ),\n    },\n  ];\n\n  React.useEffect(() => {\n    dispatch(actions.getMenuListRequest())\n  }, [dispatch])\n\n  const deleteConfirm = (record: actions.MenuTree) => {\n    confirm({\n      title: '这个是一个危险操作?',\n      icon: <ExclamationCircleOutlined />,\n      content: '确定执行删除操作吗？',\n      okText: '确定',\n      okType: 'danger',\n      cancelText: '取消',\n      onOk() {\n        dispatch(actions.deleteRowRequest({ id: record.key }))\n      },\n    });\n  }\n\n  const submit = () => {\n    if (!menuName) {\n      message.error('菜单名称不能为空');\n      return\n    }\n    if (id) {\n      dispatch(actions.UpdateRowRequest({\n        menuName: menuName,\n        id: id,\n        menuIcon: menuIcon,\n        menuRouter: menuRouter,\n        parentId: parentId,\n      } as manager.IUpdateMenuRequest))\n    } else {\n      dispatch(actions.createMenuRequest({\n        menuName: menuName.trim(),\n        menuIcon: menuIcon.trim(),\n        menuRouter: menuRouter.trim(),\n        parentId: Number(parentId),\n      } as manager.ICreateMenuRequest))\n    }\n    cancelModel()\n  }\n\n  const showModel = (record: manager.IMenuInfo) => {\n    setMenuName(record.menuName || \"\");\n    setParentId(record.parentId || \"\")\n    setMenuIcon(record.menuIcon || \"\")\n    setMenuRouter(record.menuRouter || \"\")\n    setId(record.id!);\n    setVisible(true)\n  }\n\n  const cancelModel = () => {\n    setVisible(false)\n    setMenuName(\"\");\n    setId(0)\n  }\n\n  return <>\n    <div style={{ marginBottom: '10px' }}>\n      <Button type=\"primary\" onClick={() => showModel({} as manager.ICreateMenuRequest)}>新增</Button>\n      <Modal\n        title=\"菜单\"\n        visible={visible}\n        onOk={submit}\n        onCancel={cancelModel}\n        okText=\"确认\"\n        cancelText=\"取消\"\n        style={{ top: 20 }}\n      >\n        <Form {...layout}>\n          <Form.Item label=\"上级菜单\">\n            <TreeSelect\n              allowClear={true}\n              style={{ width: '100%' }}\n              value={parentId}\n              dropdownStyle={{ maxHeight: 600, overflow: 'auto' }}\n              treeData={menuState.menuList}\n              placeholder=\"请选择...\"\n              treeDefaultExpandAll\n              onChange={(v) => setParentId(v)}\n            />\n          </Form.Item >\n          <Form.Item label={<span><strong style={{ color: \"red\" }}>*</strong>菜单名称</span>}>\n            <Input\n              onChange={(e) => setMenuName(e.target.value)}\n              value={menuName}\n            />\n          </Form.Item >\n          <Form.Item label=\"菜单路由\">\n            <Input\n              onChange={(e) => setMenuRouter(e.target.value)}\n              value={menuRouter}\n            />\n          </Form.Item >\n          <Form.Item label=\"菜单图标\">\n            <Input\n              onChange={(e) => setMenuIcon(e.target.value)}\n              value={menuIcon}\n            />\n          </Form.Item >\n        </Form>\n      </Modal>\n    </div>\n    <Table\n      columns={columns}\n      dataSource={menuState.menuList as actions.MenuTree[]}\n      rowKey={(record: manager.IMenuInfo) => record.id!}\n      pagination={false}\n    />\n  </>\n\n}\n\nexport default Menu\n"]},"metadata":{},"sourceType":"module"}