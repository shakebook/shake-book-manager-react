{"ast":null,"code":"import { manager } from '@/service/api/v1/manager_pb'; //import * as types from './types'\n\nimport axios from 'axios';\nimport camelcaseKeys from 'camelcase-keys';\nimport api from '@/requestAPI';\nimport { notification } from 'antd';\nexport function createRoleRequest(req) {\n  return dispatch => {\n    axios({\n      method: 'post',\n      url: api.role,\n      data: req,\n      headers: {\n        \"Grpc-metadata-token\": \"BEARER \" + localStorage.getItem(\"token\")\n      }\n    }).then(function (res) {\n      let ret = manager.Response.fromObject(camelcaseKeys(res.data, {\n        deep: true\n      }));\n\n      if (res.status === 200 && ret.success) {\n        notification['success']({\n          message: '信息提示',\n          description: \"新增成功\"\n        });\n      } else {\n        notification['warning']({\n          message: '信息提示',\n          description: ret.message\n        });\n        localStorage.removeItem(\"token\");\n        console.log(\"menu action:\", window.globalHistory);\n        window.globalHistory.history.push('/login');\n      }\n    }).catch(function (error) {\n      notification['error']({\n        message: '信息提示',\n        description: \"请稍后重试\"\n      });\n      localStorage.removeItem(\"token\");\n      window.globalHistory.history.push('/login');\n    });\n  };\n}","map":{"version":3,"sources":["/Users/yangjiafeng/web-src/shake-book-manager/src/pages/content/pages/menu/store/actions.ts"],"names":["manager","axios","camelcaseKeys","api","notification","createRoleRequest","req","dispatch","method","url","role","data","headers","localStorage","getItem","then","res","ret","Response","fromObject","deep","status","success","message","description","removeItem","console","log","window","globalHistory","history","push","catch","error"],"mappings":"AAAA,SAASA,OAAT,QAAwB,6BAAxB,C,CACA;;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAOC,aAAP,MAA0B,gBAA1B;AACA,OAAOC,GAAP,MAAgB,cAAhB;AACA,SAASC,YAAT,QAA6B,MAA7B;AAOA,OAAO,SAASC,iBAAT,CAA2BC,GAA3B,EAA4D;AACjE,SAAQC,QAAD,IAA6B;AAClCN,IAAAA,KAAK,CAAC;AACJO,MAAAA,MAAM,EAAE,MADJ;AAEJC,MAAAA,GAAG,EAAEN,GAAG,CAACO,IAFL;AAGJC,MAAAA,IAAI,EAAEL,GAHF;AAIJM,MAAAA,OAAO,EAAE;AACP,+BAAuB,YAAYC,YAAY,CAACC,OAAb,CAAqB,OAArB;AAD5B;AAJL,KAAD,CAAL,CAOGC,IAPH,CAOQ,UAAUC,GAAV,EAAe;AACrB,UAAIC,GAAsB,GACxBjB,OAAO,CAACkB,QAAR,CAAiBC,UAAjB,CACEjB,aAAa,CAACc,GAAG,CAACL,IAAL,EAAqB;AAChCS,QAAAA,IAAI,EAAE;AAD0B,OAArB,CADf,CADF;;AAOA,UAAIJ,GAAG,CAACK,MAAJ,KAAe,GAAf,IAAsBJ,GAAG,CAACK,OAA9B,EAAuC;AAErClB,QAAAA,YAAY,CAAC,SAAD,CAAZ,CAAwB;AACtBmB,UAAAA,OAAO,EAAE,MADa;AAEtBC,UAAAA,WAAW,EAAE;AAFS,SAAxB;AAID,OAND,MAMO;AACLpB,QAAAA,YAAY,CAAC,SAAD,CAAZ,CAAwB;AACtBmB,UAAAA,OAAO,EAAE,MADa;AAEtBC,UAAAA,WAAW,EAAEP,GAAG,CAACM;AAFK,SAAxB;AAIAV,QAAAA,YAAY,CAACY,UAAb,CAAwB,OAAxB;AACAC,QAAAA,OAAO,CAACC,GAAR,CAAY,cAAZ,EAA4BC,MAAM,CAACC,aAAnC;AACAD,QAAAA,MAAM,CAACC,aAAP,CAAqBC,OAArB,CAA6BC,IAA7B,CAAkC,QAAlC;AAED;AACF,KA/BD,EAgCGC,KAhCH,CAgCS,UAAUC,KAAV,EAAiB;AACtB7B,MAAAA,YAAY,CAAC,OAAD,CAAZ,CAAsB;AACpBmB,QAAAA,OAAO,EAAE,MADW;AAEpBC,QAAAA,WAAW,EAAE;AAFO,OAAtB;AAIAX,MAAAA,YAAY,CAACY,UAAb,CAAwB,OAAxB;AACAG,MAAAA,MAAM,CAACC,aAAP,CAAqBC,OAArB,CAA6BC,IAA7B,CAAkC,QAAlC;AACD,KAvCH;AAwCD,GAzCD;AA0CD","sourcesContent":["import { manager } from '@/service/api/v1/manager_pb'\n//import * as types from './types'\nimport axios from 'axios';\nimport camelcaseKeys from 'camelcase-keys'\nimport api from '@/requestAPI';\nimport { notification } from 'antd';\nimport { Dispatch } from \"redux\"\ndeclare global {\n  interface Window {\n    globalHistory: any\n  }\n}\nexport function createRoleRequest(req: manager.ICreateMenuRequest) {\n  return (dispatch: Dispatch<any>) => {\n    axios({\n      method: 'post',\n      url: api.role,\n      data: req,\n      headers: {\n        \"Grpc-metadata-token\": \"BEARER \" + localStorage.getItem(\"token\")\n      }\n    }).then(function (res) {\n      let ret: manager.IResponse =\n        manager.Response.fromObject(\n          camelcaseKeys(res.data as Object, {\n            deep: true\n          }),\n        )\n\n      if (res.status === 200 && ret.success) {\n\n        notification['success']({\n          message: '信息提示',\n          description: \"新增成功\"\n        });\n      } else {\n        notification['warning']({\n          message: '信息提示',\n          description: ret.message\n        });\n        localStorage.removeItem(\"token\")\n        console.log(\"menu action:\", window.globalHistory);\n        window.globalHistory.history.push('/login')\n\n      }\n    })\n      .catch(function (error) {\n        notification['error']({\n          message: '信息提示',\n          description: \"请稍后重试\"\n        });\n        localStorage.removeItem(\"token\")\n        window.globalHistory.history.push('/login')\n      });\n  }\n}"]},"metadata":{},"sourceType":"module"}