{"ast":null,"code":"import React, { useEffect } from 'react';\nimport G6 from '@antv/g6';\nimport { ErrorBoundary } from '../base';\nimport { processMinimap, getGraphSize } from './util';\nimport useGraph from '../hooks/useGraph';\nimport { deepClone } from '../util/utils';\nvar defaultStateStyles = {\n  hover: {\n    stroke: '#1890ff',\n    lineWidth: 2\n  }\n};\nvar defaultNodeSize = [150, 30];\nvar defaultNodeStyle = {\n  stroke: '#72CC4A',\n  fill: '#f00'\n};\nvar defaultNodeAnchorPoints = [[0.5, 0], [0.5, 1]];\nvar defaultEdgeStyle = {\n  stroke: '#91d5ff',\n  endArrow: {\n    path: G6.Arrow.vee(10, 10),\n    fill: '#91d5ff'\n  }\n};\nvar defaultLayout = {\n  type: 'dagre',\n  rankdir: 'LR',\n  nodesep: 30,\n  ranksep: 50\n};\nvar defaultLabelCfg = {\n  style: {\n    fill: '#000000A6',\n    fontSize: 10\n  }\n};\nvar graphs = {};\n\nvar DagreFundFlowGraph = function (_a) {\n  var data = _a.data,\n      className = _a.className,\n      style = _a.style,\n      width = _a.width,\n      height = _a.height,\n      _b = _a.nodeType,\n      nodeType = _b === void 0 ? 'round-rect' : _b,\n      _c = _a.edgeType,\n      edgeType = _c === void 0 ? 'fund-polyline' : _c,\n      _d = _a.behaviors,\n      behaviors = _d === void 0 ? ['zoom-canvas', 'drag-canvas'] : _d,\n      _e = _a.nodeSize,\n      nodeSize = _e === void 0 ? defaultNodeSize : _e,\n      _f = _a.nodeLabelCfg,\n      nodeLabelCfg = _f === void 0 ? defaultLabelCfg : _f,\n      _g = _a.edgeLabelCfg,\n      edgeLabelCfg = _g === void 0 ? defaultLabelCfg : _g,\n      _h = _a.nodeAnchorPoints,\n      nodeAnchorPoints = _h === void 0 ? defaultNodeAnchorPoints : _h,\n      _j = _a.layout,\n      layout = _j === void 0 ? defaultLayout : _j,\n      minimapCfg = _a.minimapCfg,\n      _k = _a.nodeStyle,\n      nodeStyle = _k === void 0 ? defaultNodeStyle : _k,\n      _l = _a.edgeStyle,\n      edgeStyle = _l === void 0 ? defaultEdgeStyle : _l,\n      _m = _a.nodeStateStyles,\n      nodeStateStyles = _m === void 0 ? defaultStateStyles : _m,\n      _o = _a.edgeStateStyles,\n      edgeStateStyles = _o === void 0 ? defaultStateStyles : _o,\n      _p = _a.colorMap,\n      colorMap = _p === void 0 ? {} : _p,\n      handleEdgeClick = _a.handleEdgeClick,\n      handleEdgeHover = _a.handleEdgeHover,\n      handleEdgeUnHover = _a.handleEdgeUnHover,\n      handleNodeClick = _a.handleNodeClick,\n      handleNodeHover = _a.handleNodeHover,\n      handleNodeUnHover = _a.handleNodeUnHover,\n      handleCanvasClick = _a.handleCanvasClick,\n      graphRef = _a.graphRef,\n      _q = _a.graphId,\n      graphId = _q === void 0 ? 'defaultDagreFundFlowGraph' : _q;\n  var container = React.useRef(null);\n  var props = {\n    data: data,\n    className: className,\n    style: style,\n    width: width,\n    height: height,\n    nodeType: nodeType,\n    edgeType: edgeType,\n    behaviors: behaviors,\n    nodeSize: nodeSize,\n    nodeLabelCfg: nodeLabelCfg,\n    edgeLabelCfg: edgeLabelCfg,\n    nodeAnchorPoints: nodeAnchorPoints,\n    layout: layout,\n    minimapCfg: minimapCfg,\n    nodeStyle: nodeStyle,\n    edgeStyle: edgeStyle,\n    nodeStateStyles: nodeStateStyles,\n    edgeStateStyles: edgeStateStyles,\n    colorMap: colorMap,\n    handleEdgeClick: handleEdgeClick,\n    handleEdgeHover: handleEdgeHover,\n    handleEdgeUnHover: handleEdgeUnHover,\n    handleNodeClick: handleNodeClick,\n    handleNodeHover: handleNodeHover,\n    handleNodeUnHover: handleNodeUnHover,\n    handleCanvasClick: handleCanvasClick,\n    graphRef: graphRef,\n    graphId: graphId\n  };\n  useGraph(graphs[graphId], props, container);\n  useEffect(function () {\n    var graphSize = getGraphSize(width, height, container);\n    var graph = graphs[graphId];\n\n    if (!graph) {\n      graph = new G6.Graph({\n        container: container.current,\n        width: graphSize[0],\n        height: graphSize[1],\n        modes: {\n          default: behaviors\n        },\n        defaultNode: {\n          type: nodeType,\n          size: nodeSize,\n          style: nodeStyle,\n          anchorPoints: nodeAnchorPoints,\n          labelCfg: nodeLabelCfg\n        },\n        defaultEdge: {\n          type: edgeType,\n          style: edgeStyle,\n          colorMap: colorMap,\n          labelCfg: edgeLabelCfg\n        },\n        nodeStateStyles: nodeStateStyles,\n        edgeStateStyles: edgeStateStyles,\n        layout: layout\n      });\n      graphs[graphId] = graph;\n    }\n\n    if (graphRef) {\n      graphRef.current = graph;\n    }\n\n    processMinimap(minimapCfg, graph);\n    var originData = deepClone(data);\n    graph.data(originData);\n    graph.render(); // modify the node color according to the in edge\n\n    var edges = graph.getEdges(); // @ts-ignore\n\n    edges.forEach(function (edge) {\n      var line = edge.getKeyShape();\n      var stroke = line.attr('stroke');\n      var targetNode = edge.getTarget();\n      targetNode.update({\n        style: {\n          stroke: stroke\n        }\n      });\n    });\n    graph.fitView();\n    graph.on('edge:mouseenter', function (evt) {\n      var item = evt.item;\n      graph.setItemState(item, 'hover', true);\n\n      if (handleEdgeHover) {\n        handleEdgeHover(item, graph);\n      }\n    });\n    graph.on('edge:mouseleave', function (evt) {\n      var item = evt.item;\n      graph.setItemState(item, 'hover', false);\n\n      if (handleEdgeUnHover) {\n        handleEdgeUnHover(item, graph);\n      }\n    });\n    graph.on('edge:click', function (evt) {\n      var item = evt.item;\n\n      if (handleEdgeClick) {\n        handleEdgeClick(item, graph);\n      }\n    });\n    graph.on('node:mouseenter', function (evt) {\n      var item = evt.item;\n      graph.setItemState(item, 'hover', false);\n\n      if (handleNodeHover) {\n        handleNodeHover(item, graph);\n      }\n    });\n    graph.on('node:mouseleave', function (evt) {\n      var item = evt.item;\n      graph.setItemState(item, 'hover', false);\n\n      if (handleNodeUnHover) {\n        handleNodeUnHover(item, graph);\n      }\n    });\n    graph.on('node:click', function (evt) {\n      var item = evt.item;\n\n      if (handleNodeClick) {\n        handleNodeClick(item, graph);\n      }\n    });\n    graph.on('canvas:click', function () {\n      handleCanvasClick === null || handleCanvasClick === void 0 ? void 0 : handleCanvasClick(graph);\n    });\n    return function () {\n      if (graphs[graphId]) {\n        graphs[graphId].destroy();\n        delete graphs[graphId];\n      }\n    };\n  }, []);\n  return React.createElement(ErrorBoundary, null, React.createElement(\"div\", {\n    className: className,\n    style: style,\n    ref: container\n  }));\n};\n\nexport default DagreFundFlowGraph;","map":{"version":3,"sources":["/Users/yangjiafeng/web-src/shake-book-manager/node_modules/@ant-design/charts/es/graph/dagreFundFlow.js"],"names":["React","useEffect","G6","ErrorBoundary","processMinimap","getGraphSize","useGraph","deepClone","defaultStateStyles","hover","stroke","lineWidth","defaultNodeSize","defaultNodeStyle","fill","defaultNodeAnchorPoints","defaultEdgeStyle","endArrow","path","Arrow","vee","defaultLayout","type","rankdir","nodesep","ranksep","defaultLabelCfg","style","fontSize","graphs","DagreFundFlowGraph","_a","data","className","width","height","_b","nodeType","_c","edgeType","_d","behaviors","_e","nodeSize","_f","nodeLabelCfg","_g","edgeLabelCfg","_h","nodeAnchorPoints","_j","layout","minimapCfg","_k","nodeStyle","_l","edgeStyle","_m","nodeStateStyles","_o","edgeStateStyles","_p","colorMap","handleEdgeClick","handleEdgeHover","handleEdgeUnHover","handleNodeClick","handleNodeHover","handleNodeUnHover","handleCanvasClick","graphRef","_q","graphId","container","useRef","props","graphSize","graph","Graph","current","modes","default","defaultNode","size","anchorPoints","labelCfg","defaultEdge","originData","render","edges","getEdges","forEach","edge","line","getKeyShape","attr","targetNode","getTarget","update","fitView","on","evt","item","setItemState","destroy","createElement","ref"],"mappings":"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","sourcesContent":["import React, { useEffect } from 'react';\nimport G6 from '@antv/g6';\nimport { ErrorBoundary } from '../base';\nimport { processMinimap, getGraphSize } from './util';\nimport useGraph from '../hooks/useGraph';\nimport { deepClone } from '../util/utils';\nvar defaultStateStyles = {\n    hover: {\n        stroke: '#1890ff',\n        lineWidth: 2,\n    },\n};\nvar defaultNodeSize = [150, 30];\nvar defaultNodeStyle = {\n    stroke: '#72CC4A',\n    fill: '#f00',\n};\nvar defaultNodeAnchorPoints = [\n    [0.5, 0],\n    [0.5, 1],\n];\nvar defaultEdgeStyle = {\n    stroke: '#91d5ff',\n    endArrow: {\n        path: G6.Arrow.vee(10, 10),\n        fill: '#91d5ff',\n    },\n};\nvar defaultLayout = {\n    type: 'dagre',\n    rankdir: 'LR',\n    nodesep: 30,\n    ranksep: 50,\n};\nvar defaultLabelCfg = {\n    style: {\n        fill: '#000000A6',\n        fontSize: 10,\n    },\n};\nvar graphs = {};\nvar DagreFundFlowGraph = function (_a) {\n    var data = _a.data, className = _a.className, style = _a.style, width = _a.width, height = _a.height, _b = _a.nodeType, nodeType = _b === void 0 ? 'round-rect' : _b, _c = _a.edgeType, edgeType = _c === void 0 ? 'fund-polyline' : _c, _d = _a.behaviors, behaviors = _d === void 0 ? ['zoom-canvas', 'drag-canvas'] : _d, _e = _a.nodeSize, nodeSize = _e === void 0 ? defaultNodeSize : _e, _f = _a.nodeLabelCfg, nodeLabelCfg = _f === void 0 ? defaultLabelCfg : _f, _g = _a.edgeLabelCfg, edgeLabelCfg = _g === void 0 ? defaultLabelCfg : _g, _h = _a.nodeAnchorPoints, nodeAnchorPoints = _h === void 0 ? defaultNodeAnchorPoints : _h, _j = _a.layout, layout = _j === void 0 ? defaultLayout : _j, minimapCfg = _a.minimapCfg, _k = _a.nodeStyle, nodeStyle = _k === void 0 ? defaultNodeStyle : _k, _l = _a.edgeStyle, edgeStyle = _l === void 0 ? defaultEdgeStyle : _l, _m = _a.nodeStateStyles, nodeStateStyles = _m === void 0 ? defaultStateStyles : _m, _o = _a.edgeStateStyles, edgeStateStyles = _o === void 0 ? defaultStateStyles : _o, _p = _a.colorMap, colorMap = _p === void 0 ? {} : _p, handleEdgeClick = _a.handleEdgeClick, handleEdgeHover = _a.handleEdgeHover, handleEdgeUnHover = _a.handleEdgeUnHover, handleNodeClick = _a.handleNodeClick, handleNodeHover = _a.handleNodeHover, handleNodeUnHover = _a.handleNodeUnHover, handleCanvasClick = _a.handleCanvasClick, graphRef = _a.graphRef, _q = _a.graphId, graphId = _q === void 0 ? 'defaultDagreFundFlowGraph' : _q;\n    var container = React.useRef(null);\n    var props = {\n        data: data,\n        className: className,\n        style: style,\n        width: width,\n        height: height,\n        nodeType: nodeType,\n        edgeType: edgeType,\n        behaviors: behaviors,\n        nodeSize: nodeSize,\n        nodeLabelCfg: nodeLabelCfg,\n        edgeLabelCfg: edgeLabelCfg,\n        nodeAnchorPoints: nodeAnchorPoints,\n        layout: layout,\n        minimapCfg: minimapCfg,\n        nodeStyle: nodeStyle,\n        edgeStyle: edgeStyle,\n        nodeStateStyles: nodeStateStyles,\n        edgeStateStyles: edgeStateStyles,\n        colorMap: colorMap,\n        handleEdgeClick: handleEdgeClick,\n        handleEdgeHover: handleEdgeHover,\n        handleEdgeUnHover: handleEdgeUnHover,\n        handleNodeClick: handleNodeClick,\n        handleNodeHover: handleNodeHover,\n        handleNodeUnHover: handleNodeUnHover,\n        handleCanvasClick: handleCanvasClick,\n        graphRef: graphRef,\n        graphId: graphId,\n    };\n    useGraph(graphs[graphId], props, container);\n    useEffect(function () {\n        var graphSize = getGraphSize(width, height, container);\n        var graph = graphs[graphId];\n        if (!graph) {\n            graph = new G6.Graph({\n                container: container.current,\n                width: graphSize[0],\n                height: graphSize[1],\n                modes: {\n                    default: behaviors,\n                },\n                defaultNode: {\n                    type: nodeType,\n                    size: nodeSize,\n                    style: nodeStyle,\n                    anchorPoints: nodeAnchorPoints,\n                    labelCfg: nodeLabelCfg,\n                },\n                defaultEdge: {\n                    type: edgeType,\n                    style: edgeStyle,\n                    colorMap: colorMap,\n                    labelCfg: edgeLabelCfg,\n                },\n                nodeStateStyles: nodeStateStyles,\n                edgeStateStyles: edgeStateStyles,\n                layout: layout,\n            });\n            graphs[graphId] = graph;\n        }\n        if (graphRef) {\n            graphRef.current = graph;\n        }\n        processMinimap(minimapCfg, graph);\n        var originData = deepClone(data);\n        graph.data(originData);\n        graph.render();\n        // modify the node color according to the in edge\n        var edges = graph.getEdges();\n        // @ts-ignore\n        edges.forEach(function (edge) {\n            var line = edge.getKeyShape();\n            var stroke = line.attr('stroke');\n            var targetNode = edge.getTarget();\n            targetNode.update({\n                style: {\n                    stroke: stroke,\n                },\n            });\n        });\n        graph.fitView();\n        graph.on('edge:mouseenter', function (evt) {\n            var item = evt.item;\n            graph.setItemState(item, 'hover', true);\n            if (handleEdgeHover) {\n                handleEdgeHover(item, graph);\n            }\n        });\n        graph.on('edge:mouseleave', function (evt) {\n            var item = evt.item;\n            graph.setItemState(item, 'hover', false);\n            if (handleEdgeUnHover) {\n                handleEdgeUnHover(item, graph);\n            }\n        });\n        graph.on('edge:click', function (evt) {\n            var item = evt.item;\n            if (handleEdgeClick) {\n                handleEdgeClick(item, graph);\n            }\n        });\n        graph.on('node:mouseenter', function (evt) {\n            var item = evt.item;\n            graph.setItemState(item, 'hover', false);\n            if (handleNodeHover) {\n                handleNodeHover(item, graph);\n            }\n        });\n        graph.on('node:mouseleave', function (evt) {\n            var item = evt.item;\n            graph.setItemState(item, 'hover', false);\n            if (handleNodeUnHover) {\n                handleNodeUnHover(item, graph);\n            }\n        });\n        graph.on('node:click', function (evt) {\n            var item = evt.item;\n            if (handleNodeClick) {\n                handleNodeClick(item, graph);\n            }\n        });\n        graph.on('canvas:click', function () {\n            handleCanvasClick === null || handleCanvasClick === void 0 ? void 0 : handleCanvasClick(graph);\n        });\n        return function () {\n            if (graphs[graphId]) {\n                graphs[graphId].destroy();\n                delete graphs[graphId];\n            }\n        };\n    }, []);\n    return (React.createElement(ErrorBoundary, null,\n        React.createElement(\"div\", { className: className, style: style, ref: container })));\n};\nexport default DagreFundFlowGraph;\n"]},"metadata":{},"sourceType":"module"}